{% extends 'FreshBooksPicrBundle::layout.html.twig' %}

{% block javascripts %}
{{ parent() }}
<script type="text/javascript">
  $('.picr-joke').tooltip();

  $('#form_file').on('change', function() {
    var $el = $(this);
    var $submitBtn = $('#form_save');

    if ($el.val() != '') {
      $submitBtn.prop('disabled', false);
    } else {
      $submitBtn.prop('disabled', true);
    }
  });

  Dropzone.options.myAwesomeDropzone = {
    maxFilesize: 10,
    thumbnailWidth: 200,
    thumbnailHeight: 200,
    acceptedFiles: 'image/*',

    init: function() {
      this.on("success", function(file, response) {
        $(file.previewElement).find('img').wrap("<a href='" + response[0] + "'/>");
        console.log($(file.previewElement).find('img'), response[0]);
      });
    }
  };
</script>
{% endblock %}

{% block content %}
<div class="starter-template">
  <h1>Welcome to <span class="picr-joke" title="Like Imgur, get it?" data-toggle="tooltip" data-placement="top">Picr</span>!</h1>
  <p class="lead">Drag and drop your image into the zone below or use the manual upload at the bottom</p>

  <form action="{{ path('_ajax_upload') }}" method="post" class="dropzone" id="my-awesome-dropzone"></form>

</div>

<div class="row">
  <div class="col-md-4 col-md-offset-4">
    {{ form(form) }}
  </div>
</div>

{% endblock %}
